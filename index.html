<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>沒中籤的朋友們</title>
  <script src="https://code.jquery.com/jquery-2.2.4.js"></script>
  <script src="https://cdn.jsdelivr.net/lodash/4/lodash.min.js"></script>
  <style>
    h1 span {
      font-size: 16px;
      white-space: nowrap;
    }

    .wrapper {
      display: flex;
      flex-wrap: wrap;
    }

    .number {
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      width: 90px;
      height: 90px;
      padding: 8px 15px 6px;
      font-size: 4rem;
      font-weight: 500;
      border-radius: 15px;
      background: #fff;
      border: 1px solid #ddd;
      margin-right: 8px;
      margin-bottom: 8px;
    }

    .wrapper .active,
    .wrapper .partial {
      display: none;
    }

    .control .number {
      display: inline-block;
      font-size: 2rem;
    }

    .active {
      color: #e4004d;
    }

    .partial {
      color: green;
    }

    input[type=checkbox] {
      display: none;
    }

    label {
      display: inline-block;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
    }

    .control label .all {
      background-color: #e1ecf4;
    }

    input[type=checkbox]#active:checked ~ .control label .active,
    input[type=checkbox]#partial:checked ~ .control label .partial {
      background-color: #e1ecf4;
    }

    input[type=checkbox]#active:checked ~ .wrapper .active,
    input[type=checkbox]#partial:checked ~ .wrapper .partial {
      display: block;
    }

    @media only screen and (max-device-width: 480px) {
      .number {
        width: 60px;
        height: 60px;
        font-size: 2rem;
      }
      .control .number {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <h1>沒中籤的朋友們 <span>last updated: 2020/10/20 22:00</span></h1>

  <input type="checkbox" name="partial" id="partial">
  <input type="checkbox" name="active" id="active">

  <div class="control">
    <label><div class="number all">未中籤</div></label>
    <label for="partial"><div class="number partial">看末三碼</div></label>
    <label for="active"><div class="number active">中過籤</div></label>
  </div>
  <div class="wrapper"></div>

  <script>
    // Data Schema Source: https://github.com/onlinemad/5000-lottery
    const coupons = [{
        name: '【第一週】國旅券',
        codes: ['21', '32', '98', '67', '97', '410']
      }, {
        name: '【第一週】i原券',
        codes: ['64', '85']
      }, {
        name: '【第一週】農遊券',
        codes: ['89', '32', '54', '597', '453', '152']
      }, {
        name: '【第一週】藝fun券(數位)',
        codes: ['96', '15', '07', '30', '73', '98', '19', '11']
      }, {
        name: '【第一週】藝fun券(紙本)',
        codes: ['39', '37', '23', '36', '79', '08', '14', '75']
      }, {
        name: '【第一週】動滋券',
        codes: ['97', '13', '19', '55', '71', '93', '381', '734', '644', '453', '985']
      }, {
        name: '【第一週】客庄劵2.0',
        codes: ['81', '900']
      }, {
        name: '【第一週】地方創生券',
        codes: ['081', '105', '594', '188', '089', '396', '521', '467', '912', '798', '358', '441', '367', '941', '335']
      }, {
        name: '【第二週】國旅券',
        codes: ['87', '04', '40', '29', '71']
      }, {
        name: '【第二週】i原券',
        codes: ['12', '59']
      }, {
        name: '【第二週】農遊券',
        codes: ['50', '13']
      }, {
        name: '【第二週】藝fun券(數位)',
        codes: ['78', '00', '39', '22', '61', '23', '15']
      }, {
        name: '【第二週】藝fun券(紙本)',
        codes: ['37', '76', '31', '06', '51', '65', '81']
      }]

    const zeroPad = (num, places) => String(num).padStart(places, '0')


    $(function() {
      const selected = [...new Set(_.flatten(_.map(coupons, item => item.codes)))]
      const partialList = [...new Set(selected.filter(number => number.length > 2))]
      
      console.log(partialList)
      
      for (var i = 0; i< 100; i++) {
        const isActive = selected.includes(zeroPad(i, 2))
        let isPartial = false
        if (!isActive) {
          isPartial = _.map(partialList, item => item.slice(1)).includes(zeroPad(i, 2))
        }
        $('.wrapper').append('<div class="number '+ (isActive ? 'active' : '') +' '+ (isPartial ? 'partial' : '') +'">' + zeroPad(i, 2) + '</div>');
      }
    });
  </script>
</body>
</html>